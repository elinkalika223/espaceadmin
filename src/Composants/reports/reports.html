<div class="reports-container">
  <!-- En-tÃªte -->
  <div class="reports-header">
    <div class="header-content">
      <h1>ğŸ“Š Rapports et Statistiques</h1>
      <p class="subtitle">Vue d'ensemble de l'activitÃ© de Keneya Muso</p>
    </div>
    <div class="header-actions">
      <select class="filter-select" [(ngModel)]="selectedPeriod" (change)="filterByPeriod(selectedPeriod)">
        <option value="week">Cette semaine</option>
        <option value="month" selected>Ce mois</option>
        <option value="quarter">Ce trimestre</option>
        <option value="year">Cette annÃ©e</option>
      </select>
      <button class="btn-export" (click)="exportReport('pdf')">
        ğŸ“„ Exporter PDF
      </button>
      <button class="btn-export" (click)="exportReport('excel')">
        ğŸ“Š Exporter Excel
      </button>
    </div>
  </div>

  <!-- Cartes de statistiques -->
  <div class="stats-grid">
    <div class="stat-card" *ngFor="let stat of statsCards" [style.border-left-color]="stat.color">
      <div class="stat-icon" [style.background-color]="stat.color + '20'">
        <span>{{ stat.icon }}</span>
      </div>
      <div class="stat-content">
        <h3 class="stat-title">{{ stat.title }}</h3>
        <div class="stat-value">{{ stat.value }}{{ stat.title === 'Taux Suivi' ? '%' : '' }}</div>
        <div class="stat-footer">
          <span class="stat-subtitle">{{ stat.subtitle }}</span>
          <span class="stat-trend" [ngClass]="getTrendClass(stat.trend)">
            {{ getTrendIcon(stat.trend) }} {{ stat.trend }}%
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Graphiques -->
  <div class="charts-grid">
    <div class="chart-card">
      <div class="chart-header">
        <h3>ğŸ“ˆ Ã‰volution des Patientes</h3>
      </div>
      <div class="chart-container">
        <canvas id="patientsChart"></canvas>
      </div>
    </div>

    <div class="chart-card">
      <div class="chart-header">
        <h3>ğŸ“‹ Consultations Hebdomadaires</h3>
      </div>
      <div class="chart-container">
        <canvas id="consultationsChart"></canvas>
      </div>
    </div>

    <div class="chart-card">
      <div class="chart-header">
        <h3>ğŸ¯ RÃ©partition des Patientes</h3>
      </div>
      <div class="chart-container">
        <canvas id="statusChart"></canvas>
      </div>
    </div>
  </div>

  <!-- Section Tableaux -->
  <div class="tables-section">
    <!-- Tableau des patientes -->
    <div class="table-card">
      <div class="table-header">
        <h3>ğŸ‘¥ Patientes RÃ©centes</h3>
        <div class="table-filters">
          <select class="filter-select-small" [(ngModel)]="selectedStatut" (change)="filterByStatut(selectedStatut)">
            <option value="all">Tous les statuts</option>
            <option value="prenatale">PrÃ©natale</option>
            <option value="postnatale">Postnatale</option>
          </select>
        </div>
      </div>
      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Nom Complet</th>
              <th>Ã‚ge</th>
              <th>Statut</th>
              <th>Date Inscription</th>
              <th>Consultations</th>
              <th>Prochain RDV</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let patiente of patientes.slice(0, 15)">
              <td>#{{ patiente.id }}</td>
              <td class="patient-name">
                <div class="avatar">{{ patiente.prenom.charAt(0) }}{{ patiente.nom.charAt(0) }}</div>
                {{ patiente.prenom }} {{ patiente.nom }}
              </td>
              <td>{{ patiente.age }} ans</td>
              <td>
                <span class="badge" [ngClass]="getStatutClass(patiente.statut)">
                  {{ patiente.statut === 'prenatale' ? 'PrÃ©natale' : 'Postnatale' }}
                </span>
              </td>
              <td>{{ formatDate(patiente.dateInscription) }}</td>
              <td>
                <span class="consultation-count">{{ patiente.nombreConsultations }}</span>
              </td>
              <td>
                <span *ngIf="patiente.prochainRDV" class="rdv-date">
                  {{ formatDate(patiente.prochainRDV) }}
                </span>
                <span *ngIf="!patiente.prochainRDV" class="no-rdv">-</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="table-footer">
        <span>Affichage de 15 sur {{ patientes.length }} patientes</span>
        <button class="btn-link">Voir tout â†’</button>
      </div>
    </div>

    <!-- Tableau des consultations -->
    <div class="table-card">
      <div class="table-header">
        <h3>ğŸ“‹ Consultations RÃ©centes</h3>
      </div>
      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Patiente</th>
              <th>MÃ©decin</th>
              <th>Type</th>
              <th>Statut</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let consultation of consultations.slice(0, 10)">
              <td>{{ formatDate(consultation.date) }}</td>
              <td class="patient-name-simple">{{ consultation.patiente }}</td>
              <td>{{ consultation.medecin }}</td>
              <td>
                <span class="type-badge">{{ consultation.type }}</span>
              </td>
              <td>
                <span class="badge" [ngClass]="getConsultationStatutClass(consultation.statut)">
                  {{ consultation.statut === 'completee' ? 'ComplÃ©tÃ©e' : 
                     consultation.statut === 'annulee' ? 'AnnulÃ©e' : 'En attente' }}
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="table-footer">
        <span>Affichage de 10 sur {{ consultations.length }} consultations</span>
        <button class="btn-link">Voir tout â†’</button>
      </div>
    </div>
  </div>

  <!-- Statistiques supplÃ©mentaires -->
  <div class="additional-stats">
    <div class="stat-box">
      <div class="stat-box-header">
        <span class="stat-box-icon">ğŸ¥</span>
        <h4>Performance Globale</h4>
      </div>
      <div class="stat-box-content">
        <div class="progress-item">
          <div class="progress-label">
            <span>Taux de prÃ©sence</span>
            <strong>89%</strong>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width: 89%;"></div>
          </div>
        </div>
        <div class="progress-item">
          <div class="progress-label">
            <span>Satisfaction patientes</span>
            <strong>95%</strong>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width: 95%; background: #4CAF50;"></div>
          </div>
        </div>
        <div class="progress-item">
          <div class="progress-label">
            <span>Suivi rÃ©gulier</span>
            <strong>87%</strong>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width: 87%; background: #FF9800;"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="stat-box">
      <div class="stat-box-header">
        <span class="stat-box-icon">â°</span>
        <h4>ActivitÃ© RÃ©cente</h4>
      </div>
      <div class="stat-box-content">
        <div class="activity-item">
          <div class="activity-dot" style="background: #4CAF50;"></div>
          <div class="activity-content">
            <p><strong>Nouvel accouchement</strong></p>
            <span class="activity-time">Il y a 2 heures</span>
          </div>
        </div>
        <div class="activity-item">
          <div class="activity-dot" style="background: #2196F3;"></div>
          <div class="activity-content">
            <p><strong>12 nouvelles consultations</strong></p>
            <span class="activity-time">Aujourd'hui</span>
          </div>
        </div>
        <div class="activity-item">
          <div class="activity-dot" style="background: #E91E63;"></div>
          <div class="activity-content">
            <p><strong>5 nouvelles inscriptions</strong></p>
            <span class="activity-time">Cette semaine</span>
          </div>
        </div>
        <div class="activity-item">
          <div class="activity-dot" style="background: #FF9800;"></div>
          <div class="activity-content">
            <p><strong>3 rappels de vaccination</strong></p>
            <span class="activity-time">Ã€ venir</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
